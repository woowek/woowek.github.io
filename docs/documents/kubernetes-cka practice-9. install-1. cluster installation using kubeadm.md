---
title: 
parent: Documents
layout: default
---

# 

> Source: `kubernetes/cka practice/9. install/1. cluster installation using kubeadm.md`

---

1. Install the kubeadm and kubelet packages on the controlplane and node01 nodes.<br>
Use the exact version of 1.31.0-1.1 for both.
    - https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/install-kubeadm/ 참고
    - install 할 때 sudo apt-get install -y kubelet=1.31.0-1.1 kubeadm=1.31.0-1.1 kubectl=1.31.0-1.1 로 버전 지정을 한다..
    ```sh
    sudo apt-get update

    sudo apt-get install -y apt-transport-https ca-certificates curl

    curl -fsSL https://pkgs.k8s.io/core:/stable:/v1.31/deb/Release.key | sudo gpg --dearmor -o /etc/apt/keyrings/kubernetes-apt-keyring.gpg

    echo 'deb [signed-by=/etc/apt/keyrings/kubernetes-apt-keyring.gpg] https://pkgs.k8s.io/core:/stable:/v1.31/deb/ /' | sudo tee /etc/apt/sources.list.d/kubernetes.list

    sudo apt-get update

    # To see the new version labels
    sudo apt-cache madison kubeadm

    sudo apt-get install -y kubelet=1.31.0-1.1 kubeadm=1.31.0-1.1 kubectl=1.31.0-1.1

    sudo apt-mark hold kubelet kubeadm kubectl
    ```



2. What is the version of kubelet installed?



3. How many nodes are part of kubernetes cluster currently?<br>
Are you able to run kubectl get nodes?
    - 




4. Lets now bootstrap a kubernetes cluster using kubeadm.<br>
The latest version of Kubernetes will be installed.



5. Initialize Control Plane Node (Master Node). Use the following options:<br>
apiserver-advertise-address - Use the IP address allocated to eth0 on the controlplane node<br>
apiserver-cert-extra-sans - Set it to controlplane<br>
pod-network-cidr - Set to 10.244.0.0/16<br>
Once done, set up the default kubeconfig file and wait for node to be part of the cluster.<br>
    - ifconfig eth0 명령어로 아이피를 찾고
    - kubeadm init --apiserver-cert-extra-sans=controlplane --apiserver-advertise-address=192.10.192.3 --pod-network-cidr=10.244.0.0/16 실행
    - 아래 명령어로 설정파일 이동
    - mkdir -p $HOME/.kube
    - sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config
    - sudo chown $(id -u):$(id -g) $HOME/.kube/config



6. Generate a kubeadm join token<br>
Or copy the one that was generated by kubeadm init command


7. Join node01 to the cluster using the join token
    - kubeadm token create --print-join-command 로 토큰 확인
    - node01로 이동 후 아래 명령어로 join
    - kubeadm join 192.10.192.3:6443 --token 677uk3.aomwisl9xkgqhdi9 --discovery-token-ca-cert-hash sha256:fead94675f5fcd42c47b65836947b494021aa1ef51e81cae1e4ddda589c3a8e5 


8. To install a network plugin, we will go with Flannel as the default choice. For inter-host communication, we will utilize the eth0 interface.<br>
Please ensure that the Flannel manifest includes the appropriate options for this configuration.<br>
Refer to the official documentation for the procedure.
    - curl -LO https://raw.githubusercontent.com/flannel-io/flannel/v0.20.2/Documentation/kube-flannel.yml 입력
    - - --kube-subnet-mgr 부분 찾고'
    - 아래에 --iface=eth0 추가
    - kubectl apply -f kube-flannel.yml 로 apply